## Лаба 7. Построить content-based рекомендательную систему образовательных курсов

##### [![New Professions Lab — Big Data 8](http://data.newprolab.com/public-newprolab-com/npl7.svg)](https://github.com/newprolab/content_bigdata8)

### Дедлайн

⏰ Понедельник, 21 мая 2018 года, 23:59.

### Задача

По имеющимся данным портала eclass.cc построить content-based рекомендации по образовательным курсам.

#### Обработка данных на вход

Имеются следующие входные данные:
* Набор данных о всех курсах. Датасет взять с HDFS по адресу: `/labs/lab07data/DO_record_per_line.json`
* id курсов, для которых надо дать рекомендации (указаны в [Личном кабинете](http://lk.newprolab.com/lab/laba07)) 

#### Обработка данных на выход

Для каждого id курса необходимо дать топ-10 наиболее похожих на него курсов. Рекомендованные курсы должны быть того же языка, что и курс, для которого строится рекомендация.

Для подбора рекомендаций следует использовать меру TF\*IDF, а в качестве метрики для ранжирования — косинус угла между TF\*IDF-векторами для разных курсов.

TF\*IDF нужно считать для описаний курсов. При извлечении слов из описания словом считаем то, что состоит из латинских или кириллических букв или цифр, знаки препинания и прочие символы не учитываются.

Для поиска слов можно использовать такой код:
```
regex = re.compile(ur'[\w\d]{2,}', re.U)
regex.findall(string.lower())
```

Выходной формат — json — должен иметь следующую структуру:

```
{
  "123": [
    5372,
    16663,
    23114,
    13079,
    13084,
    ...
  ],
  "456": [
    ...
  ],
  "789": [
    ...
  ],
  "123456": [
    ...
  ],
  "456789": [
    ...
  ],
  "987654": [
    ...
  ]
}
```

Ключи — это id курсов, для которых строится рекомендация. Для каждого такого ключа в качестве значения задается массив рекомендованных курсов, состоящий из их id, отсортированных по убыванию метрики. При равенстве значений метрики курсы сортируются лексикографически по названию. 

Также возможна очень редкая ситуация (в основном с русскоязычными курсами), когда в рекомендацию попадут два дубликата одного курса, но с разными id. Таких дубликатов очень мало относительно числа курсов, но все равно рекомендуется сортировать в следующей последовательности: по метрике (убывание) => по названию (лексикографически по возрастанию) => по возрастанию id.

**При вычислении TF с помощью `HashingTF` использовалось число фичей 10000. То есть: `tf = HashingTF(10000)`.**

### Проверка

Проверка осуществляется по результатам рекомендаций текущей рекомендательной системы на eclass.cc. Для прохождения лабораторной для каждого курса, для которого строится рекомендация, должно быть пересечение рекомендованных курсов с результатами текущей системы — **не менее 20%.**

Файл необходимо положить в свою домашнюю директорию под названием: `lab07.json`. Проверка осуществляется из [Личного кабинета](http://lk.newprolab.com/lab/laba07). В чекере в качестве значения для курсов указаны id и доля пересечения конкретно для каждого из курсов.
